{"ast":null,"code":"\"use client\";\n\nimport _slicedToArray from \"/Users/shamryshiraz/Documents/New/Untitled/Portfolio/New/Portfolio-Ruwan-Prasanna/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport React, { useContext } from 'react';\nimport RcColorPicker from '@rc-component/color-picker';\nimport useLayoutEffect from \"rc-util/es/hooks/useLayoutEffect\";\nimport Segmented from '../../../segmented';\nimport { AggregationColor } from '../../color';\nimport { PanelPickerContext } from '../../context';\nimport { genAlphaColor, generateColor } from '../../util';\nimport ColorClear from '../ColorClear';\nimport ColorInput from '../ColorInput';\nimport ColorSlider from '../ColorSlider';\nimport GradientColorBar from './GradientColorBar';\nvar components = {\n  slider: ColorSlider\n};\n\nvar PanelPicker = function PanelPicker() {\n  var panelPickerContext = useContext(PanelPickerContext);\n\n  var mode = panelPickerContext.mode,\n      onModeChange = panelPickerContext.onModeChange,\n      modeOptions = panelPickerContext.modeOptions,\n      prefixCls = panelPickerContext.prefixCls,\n      allowClear = panelPickerContext.allowClear,\n      value = panelPickerContext.value,\n      disabledAlpha = panelPickerContext.disabledAlpha,\n      _onChange = panelPickerContext.onChange,\n      onClear = panelPickerContext.onClear,\n      onChangeComplete = panelPickerContext.onChangeComplete,\n      activeIndex = panelPickerContext.activeIndex,\n      gradientDragging = panelPickerContext.gradientDragging,\n      injectProps = __rest(panelPickerContext, [\"mode\", \"onModeChange\", \"modeOptions\", \"prefixCls\", \"allowClear\", \"value\", \"disabledAlpha\", \"onChange\", \"onClear\", \"onChangeComplete\", \"activeIndex\", \"gradientDragging\"]); // ============================ Colors ============================\n\n\n  var colors = React.useMemo(function () {\n    if (!value.cleared) {\n      return value.getColors();\n    }\n\n    return [{\n      percent: 0,\n      color: new AggregationColor('')\n    }, {\n      percent: 100,\n      color: new AggregationColor('')\n    }];\n  }, [value]); // ========================= Single Color =========================\n\n  var isSingle = !value.isGradient(); // We cache the point color in case user drag the gradient point across another one\n\n  var _React$useState = React.useState(value),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      lockedColor = _React$useState2[0],\n      setLockedColor = _React$useState2[1]; // Use layout effect here since `useEffect` will cause a blink when mouseDown\n\n\n  useLayoutEffect(function () {\n    var _a;\n\n    if (!isSingle) {\n      setLockedColor((_a = colors[activeIndex]) === null || _a === void 0 ? void 0 : _a.color);\n    }\n  }, [gradientDragging, activeIndex]);\n  var activeColor = React.useMemo(function () {\n    var _a;\n\n    if (isSingle) {\n      return value;\n    } // Use cache when dragging. User can not operation panel when dragging.\n\n\n    if (gradientDragging) {\n      return lockedColor;\n    }\n\n    return (_a = colors[activeIndex]) === null || _a === void 0 ? void 0 : _a.color;\n  }, [value, activeIndex, isSingle, lockedColor, gradientDragging]); // ========================= Picker Color =========================\n\n  var _React$useState3 = React.useState(activeColor),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      pickerColor = _React$useState4[0],\n      setPickerColor = _React$useState4[1];\n\n  var _React$useState5 = React.useState(0),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      forceSync = _React$useState6[0],\n      setForceSync = _React$useState6[1];\n\n  var mergedPickerColor = (pickerColor === null || pickerColor === void 0 ? void 0 : pickerColor.equals(activeColor)) ? activeColor : pickerColor;\n  useLayoutEffect(function () {\n    setPickerColor(activeColor);\n  }, [forceSync, activeColor === null || activeColor === void 0 ? void 0 : activeColor.toHexString()]); // ============================ Change ============================\n\n  var fillColor = function fillColor(nextColor, info) {\n    var submitColor = generateColor(nextColor); // Fill alpha color to 100% if origin is cleared color\n\n    if (value.cleared) {\n      var rgb = submitColor.toRgb(); // Auto fill color if origin is `0/0/0` to enhance user experience\n\n      if (!rgb.r && !rgb.g && !rgb.b && info) {\n        var infoType = info.type,\n            _info$value = info.value,\n            infoValue = _info$value === void 0 ? 0 : _info$value;\n        submitColor = new AggregationColor({\n          h: infoType === 'hue' ? infoValue : 0,\n          s: 1,\n          b: 1,\n          a: infoType === 'alpha' ? infoValue / 100 : 1\n        });\n      } else {\n        submitColor = genAlphaColor(submitColor);\n      }\n    }\n\n    if (mode === 'single') {\n      return submitColor;\n    }\n\n    var nextColors = _toConsumableArray(colors);\n\n    nextColors[activeIndex] = Object.assign(Object.assign({}, nextColors[activeIndex]), {\n      color: submitColor\n    });\n    return new AggregationColor(nextColors);\n  };\n\n  var onPickerChange = function onPickerChange(colorValue, fromPicker, info) {\n    var nextColor = fillColor(colorValue, info);\n    setPickerColor(nextColor.isGradient() ? nextColor.getColors()[activeIndex].color : nextColor);\n\n    _onChange(nextColor, fromPicker);\n  };\n\n  var onInternalChangeComplete = function onInternalChangeComplete(nextColor, info) {\n    // Trigger complete event\n    onChangeComplete(fillColor(nextColor, info)); // Back of origin color in case in controlled\n    // This will set after `onChangeComplete` to avoid `setState` trigger rerender\n    // which will make `fillColor` get wrong `color.cleared` state\n\n    setForceSync(function (ori) {\n      return ori + 1;\n    });\n  };\n\n  var onInputChange = function onInputChange(colorValue) {\n    _onChange(fillColor(colorValue));\n  }; // ============================ Render ============================\n  // Operation bar\n\n\n  var operationNode = null;\n  var showMode = modeOptions.length > 1;\n\n  if (allowClear || showMode) {\n    operationNode = /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\".concat(prefixCls, \"-operation\")\n    }, showMode && /*#__PURE__*/React.createElement(Segmented, {\n      size: \"small\",\n      options: modeOptions,\n      value: mode,\n      onChange: onModeChange\n    }), /*#__PURE__*/React.createElement(ColorClear, Object.assign({\n      prefixCls: prefixCls,\n      value: value,\n      onChange: function onChange(clearColor) {\n        _onChange(clearColor);\n\n        onClear === null || onClear === void 0 ? void 0 : onClear();\n      }\n    }, injectProps)));\n  } // Return\n\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, operationNode, /*#__PURE__*/React.createElement(GradientColorBar, Object.assign({}, panelPickerContext, {\n    colors: colors\n  })), /*#__PURE__*/React.createElement(RcColorPicker, {\n    prefixCls: prefixCls,\n    value: mergedPickerColor === null || mergedPickerColor === void 0 ? void 0 : mergedPickerColor.toHsb(),\n    disabledAlpha: disabledAlpha,\n    onChange: function onChange(colorValue, info) {\n      onPickerChange(colorValue, true, info);\n    },\n    onChangeComplete: function onChangeComplete(colorValue, info) {\n      onInternalChangeComplete(colorValue, info);\n    },\n    components: components\n  }), /*#__PURE__*/React.createElement(ColorInput, Object.assign({\n    value: activeColor,\n    onChange: onInputChange,\n    prefixCls: prefixCls,\n    disabledAlpha: disabledAlpha\n  }, injectProps)));\n};\n\nexport default PanelPicker;","map":{"version":3,"sources":["/Users/shamryshiraz/Documents/New/Untitled/Portfolio/New/Portfolio-Ruwan-Prasanna/node_modules/antd/es/color-picker/components/PanelPicker/index.js"],"names":["_toConsumableArray","__rest","s","e","t","p","Object","prototype","hasOwnProperty","call","indexOf","getOwnPropertySymbols","i","length","propertyIsEnumerable","React","useContext","RcColorPicker","useLayoutEffect","Segmented","AggregationColor","PanelPickerContext","genAlphaColor","generateColor","ColorClear","ColorInput","ColorSlider","GradientColorBar","components","slider","PanelPicker","panelPickerContext","mode","onModeChange","modeOptions","prefixCls","allowClear","value","disabledAlpha","onChange","onClear","onChangeComplete","activeIndex","gradientDragging","injectProps","colors","useMemo","cleared","getColors","percent","color","isSingle","isGradient","useState","lockedColor","setLockedColor","_a","activeColor","pickerColor","setPickerColor","forceSync","setForceSync","mergedPickerColor","equals","toHexString","fillColor","nextColor","info","submitColor","rgb","toRgb","r","g","b","infoType","type","infoValue","h","a","nextColors","assign","onPickerChange","colorValue","fromPicker","onInternalChangeComplete","ori","onInputChange","operationNode","showMode","createElement","className","size","options","clearColor","Fragment","toHsb"],"mappings":"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","sourcesContent":["\"use client\";\n\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nimport React, { useContext } from 'react';\nimport RcColorPicker from '@rc-component/color-picker';\nimport useLayoutEffect from \"rc-util/es/hooks/useLayoutEffect\";\nimport Segmented from '../../../segmented';\nimport { AggregationColor } from '../../color';\nimport { PanelPickerContext } from '../../context';\nimport { genAlphaColor, generateColor } from '../../util';\nimport ColorClear from '../ColorClear';\nimport ColorInput from '../ColorInput';\nimport ColorSlider from '../ColorSlider';\nimport GradientColorBar from './GradientColorBar';\nconst components = {\n  slider: ColorSlider\n};\nconst PanelPicker = () => {\n  const panelPickerContext = useContext(PanelPickerContext);\n  const {\n      mode,\n      onModeChange,\n      modeOptions,\n      prefixCls,\n      allowClear,\n      value,\n      disabledAlpha,\n      onChange,\n      onClear,\n      onChangeComplete,\n      activeIndex,\n      gradientDragging\n    } = panelPickerContext,\n    injectProps = __rest(panelPickerContext, [\"mode\", \"onModeChange\", \"modeOptions\", \"prefixCls\", \"allowClear\", \"value\", \"disabledAlpha\", \"onChange\", \"onClear\", \"onChangeComplete\", \"activeIndex\", \"gradientDragging\"]);\n  // ============================ Colors ============================\n  const colors = React.useMemo(() => {\n    if (!value.cleared) {\n      return value.getColors();\n    }\n    return [{\n      percent: 0,\n      color: new AggregationColor('')\n    }, {\n      percent: 100,\n      color: new AggregationColor('')\n    }];\n  }, [value]);\n  // ========================= Single Color =========================\n  const isSingle = !value.isGradient();\n  // We cache the point color in case user drag the gradient point across another one\n  const [lockedColor, setLockedColor] = React.useState(value);\n  // Use layout effect here since `useEffect` will cause a blink when mouseDown\n  useLayoutEffect(() => {\n    var _a;\n    if (!isSingle) {\n      setLockedColor((_a = colors[activeIndex]) === null || _a === void 0 ? void 0 : _a.color);\n    }\n  }, [gradientDragging, activeIndex]);\n  const activeColor = React.useMemo(() => {\n    var _a;\n    if (isSingle) {\n      return value;\n    }\n    // Use cache when dragging. User can not operation panel when dragging.\n    if (gradientDragging) {\n      return lockedColor;\n    }\n    return (_a = colors[activeIndex]) === null || _a === void 0 ? void 0 : _a.color;\n  }, [value, activeIndex, isSingle, lockedColor, gradientDragging]);\n  // ========================= Picker Color =========================\n  const [pickerColor, setPickerColor] = React.useState(activeColor);\n  const [forceSync, setForceSync] = React.useState(0);\n  const mergedPickerColor = (pickerColor === null || pickerColor === void 0 ? void 0 : pickerColor.equals(activeColor)) ? activeColor : pickerColor;\n  useLayoutEffect(() => {\n    setPickerColor(activeColor);\n  }, [forceSync, activeColor === null || activeColor === void 0 ? void 0 : activeColor.toHexString()]);\n  // ============================ Change ============================\n  const fillColor = (nextColor, info) => {\n    let submitColor = generateColor(nextColor);\n    // Fill alpha color to 100% if origin is cleared color\n    if (value.cleared) {\n      const rgb = submitColor.toRgb();\n      // Auto fill color if origin is `0/0/0` to enhance user experience\n      if (!rgb.r && !rgb.g && !rgb.b && info) {\n        const {\n          type: infoType,\n          value: infoValue = 0\n        } = info;\n        submitColor = new AggregationColor({\n          h: infoType === 'hue' ? infoValue : 0,\n          s: 1,\n          b: 1,\n          a: infoType === 'alpha' ? infoValue / 100 : 1\n        });\n      } else {\n        submitColor = genAlphaColor(submitColor);\n      }\n    }\n    if (mode === 'single') {\n      return submitColor;\n    }\n    const nextColors = _toConsumableArray(colors);\n    nextColors[activeIndex] = Object.assign(Object.assign({}, nextColors[activeIndex]), {\n      color: submitColor\n    });\n    return new AggregationColor(nextColors);\n  };\n  const onPickerChange = (colorValue, fromPicker, info) => {\n    const nextColor = fillColor(colorValue, info);\n    setPickerColor(nextColor.isGradient() ? nextColor.getColors()[activeIndex].color : nextColor);\n    onChange(nextColor, fromPicker);\n  };\n  const onInternalChangeComplete = (nextColor, info) => {\n    // Trigger complete event\n    onChangeComplete(fillColor(nextColor, info));\n    // Back of origin color in case in controlled\n    // This will set after `onChangeComplete` to avoid `setState` trigger rerender\n    // which will make `fillColor` get wrong `color.cleared` state\n    setForceSync(ori => ori + 1);\n  };\n  const onInputChange = colorValue => {\n    onChange(fillColor(colorValue));\n  };\n  // ============================ Render ============================\n  // Operation bar\n  let operationNode = null;\n  const showMode = modeOptions.length > 1;\n  if (allowClear || showMode) {\n    operationNode = /*#__PURE__*/React.createElement(\"div\", {\n      className: `${prefixCls}-operation`\n    }, showMode && (/*#__PURE__*/React.createElement(Segmented, {\n      size: \"small\",\n      options: modeOptions,\n      value: mode,\n      onChange: onModeChange\n    })), /*#__PURE__*/React.createElement(ColorClear, Object.assign({\n      prefixCls: prefixCls,\n      value: value,\n      onChange: clearColor => {\n        onChange(clearColor);\n        onClear === null || onClear === void 0 ? void 0 : onClear();\n      }\n    }, injectProps)));\n  }\n  // Return\n  return /*#__PURE__*/React.createElement(React.Fragment, null, operationNode, /*#__PURE__*/React.createElement(GradientColorBar, Object.assign({}, panelPickerContext, {\n    colors: colors\n  })), /*#__PURE__*/React.createElement(RcColorPicker, {\n    prefixCls: prefixCls,\n    value: mergedPickerColor === null || mergedPickerColor === void 0 ? void 0 : mergedPickerColor.toHsb(),\n    disabledAlpha: disabledAlpha,\n    onChange: (colorValue, info) => {\n      onPickerChange(colorValue, true, info);\n    },\n    onChangeComplete: (colorValue, info) => {\n      onInternalChangeComplete(colorValue, info);\n    },\n    components: components\n  }), /*#__PURE__*/React.createElement(ColorInput, Object.assign({\n    value: activeColor,\n    onChange: onInputChange,\n    prefixCls: prefixCls,\n    disabledAlpha: disabledAlpha\n  }, injectProps)));\n};\nexport default PanelPicker;"]},"metadata":{},"sourceType":"module"}